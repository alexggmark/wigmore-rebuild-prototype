<header x-data="navigationMenu()" class="relative z-50">
  <!-- Announcement bar -->
  <div class="bg-brand-primary-700 px-4 py-1.5 text-brand-light rounded-3xl mb-3 text-center">
    <span class="text-sm">
      Lorem, ipsum dolor
      <a href="#" class="inline-block underline"> sit amet consectetur </a>
    </span>
  </div>
  <!-- Navigation -->
  <div class="flex flex-row gap-4 mb-3 w-full">
    <!-- Rounded block 1 -->
    <div class="grow flex justify-between items-center px-5 py-2 gap-8 border-b border-neutral-200/80 bg-brand-light rounded-3xl">
      <a class="block text-teal-600" href="#">
        <span class="sr-only">Home</span>
        <svg width="54" height="30" viewBox="0 0 54 30" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M53.8648 0.58332C50.982 0.58332 48.2718 2.74559 46.6245 6.25488L35.7329 30H34.4376L26.9028 16.9749L20.9578 30H19.6625L4.65261 3.99656C3.003 1.15961 2.41402 0.58332 0.17773 0.58332C-0.0592433 0.58332 -0.0592433 0.0046853 0.17773 0.0046853C1.10568 0.00780884 2.55283 0.00780884 4.51917 0.0046853C9.70958 0.00234265 11.4213 0.0046853 13.0111 0.0046853C13.2458 0.0046853 13.2458 0.580978 13.0111 0.580978C9.774 0.580978 9.59684 1.30251 11.656 4.85866L22.2531 23.2204L25.9618 15.2881L19.4278 3.99422C18.1923 1.87881 17.0742 0.580978 15.6592 0.580978C15.4222 0.580978 15.4222 0.0046853 15.6592 0.0046853C16.8372 0.0046853 16.8579 0.0046853 19.3312 0.0046853C23.7462 0.0046853 25.1381 0.0046853 26.4334 0.0046853C26.6704 0.0046853 26.6704 0.580978 26.4334 0.580978C24.3145 0.580978 24.3743 1.30251 26.4334 4.85866L29.024 9.32844L30.4965 6.10729C32.2635 2.30985 32.2635 0.578635 30.3194 0.578635C30.0824 0.578635 30.0824 0.00234265 30.3194 0.00234265C31.4973 0.00234265 30.5839 0.00234265 34.1155 0.00234265C36.0573 0.00234265 36.9707 0.00234265 38.7377 0.00234265C38.9148 0.00234265 38.9148 0.578635 38.7377 0.578635C36.0895 0.578635 33.9683 2.4059 32.2036 6.2502L30.0249 11.0081L37.0903 23.1688L44.685 6.58519C46.2748 3.12276 44.9795 0.576292 42.0369 0.576292C41.7999 0.576292 41.7999 0 42.0369 0C44.096 0 45.6927 0 48.633 0C50.8118 0 51.8655 0 53.8671 0C54.0443 0 54.0443 0.576292 53.8671 0.576292L53.8648 0.58332Z" fill="#128B9B"/>
        </svg>
      </a>

      <div class="flex flex-row gap-4 w-full justify-between items-center">
        <nav class="relative z-10 border border-red-400">
          <div class="relative">
            <ul class="flex flex-1 justify-center items-center p-1 space-x-1 list-none text-neutral-700 group">
              <template x-for="(item, index) in menuItems" :key="index">
                <li>
                  <template x-if="item.dropdown">
                    <button
                      :class="{ 'bg-neutral-100' : navigationMenu === item.id, 'hover:bg-neutral-100' : navigationMenu !== item.id }" 
                      @mouseenter="openMenu(item.id)" 
                      @mouseleave="scheduleClose()" 
                      class="inline-flex justify-center items-center px-4 py-2 w-max h-10 text-xs font-bold tracking-wide uppercase rounded-full transition-colors hover:text-neutral-900 focus:outline-none disabled:opacity-50 disabled:pointer-events-none group">
                      <span x-text="item.label"></span> 
                      <svg :class="{ '-rotate-180' : navigationMenuOpen && navigationMenu === item.id }" 
                          class="relative top-px ml-1 h-3 w-3 ease-out duration-300" 
                          xmlns="http://www.w3.org/2000/svg" 
                          viewBox="0 0 24 24" 
                          fill="none" 
                          stroke="currentColor" 
                          stroke-width="2" 
                          stroke-linecap="round" 
                          stroke-linejoin="round">
                          <polyline points="6 9 12 15 18 9"></polyline>
                      </svg>
                    </button>
                  </template>
                  <template x-if="!item.dropdown">
                    <a :href="item.url" 
                      class="inline-flex justify-center items-center px-4 py-2 w-max h-10 text-xs font-bold tracking-wide uppercase rounded-full transition-colors hover:text-neutral-900 focus:outline-none disabled:opacity-50 disabled:pointer-events-none bg-background hover:bg-neutral-100 group">
                      <span x-text="item.label"></span>
                    </a>
                  </template>
                </li>
              </template>
            </ul>
          </div>
        </nav>

        <div class="flex items-center gap-2 px-4 py-2 w-56 bg-brand-background-secondary border border-brand-border rounded-full">
          <svg xmlns="http://www.w3.org/2000/svg" class="size-4 text-neutral-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
          </svg>
          <span class="text-sm text-neutral-500">Search</span>
        </div>
      </div>
    </div>

    <!-- Rounded block 2 -->
    <div class="shrink-0 flex items-center gap-4 border-b border-neutral-200/80 bg-brand-light rounded-3xl">
      <div class="sm:flex sm:gap-2">
        <a class="bg-brand-primary inline-flex justify-center items-center px-4 py-2 w-max h-10 text-xs font-medium uppercase rounded-full text-white transition hover:bg-teal-700" href="#">
          Login
        </a>

        <a class="bg-gray-100 inline-flex justify-center items-center px-4 py-2 w-max h-10 text-xs font-medium uppercase rounded-full text-brand-primary-700 transition hover:text-teal-600/75" href="#">
          Register
        </a>
      </div>

      <button class="block rounded-sm bg-gray-100 p-2.5 text-gray-600 transition hover:text-gray-600/75 md:hidden">
        <span class="sr-only">Toggle menu</span>
        <svg xmlns="http://www.w3.org/2000/svg" class="size-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
      </button>
    </div>
  </div>

  <!-- Fixed full-width dropdown container -->
  <div x-show="navigationMenuOpen"
      x-transition:enter="transition ease-out duration-200"
      x-transition:enter-start="opacity-0 -translate-y-2"
      x-transition:enter-end="opacity-100 translate-y-0"
      x-transition:leave="transition ease-in duration-150"
      x-transition:leave-start="opacity-100 translate-y-0"
      x-transition:leave-end="opacity-0 -translate-y-2"
      @mouseenter="cancelClose()" 
      @mouseleave="scheduleClose()"
      class="absolute mx-auto left-0 right-0 mt-0 w-full bg-brand-background rounded-3xl mb-3 shadow-md"
      x-cloak>

      <div class="w-full">
          <div class="max-w-5xl mx-auto overflow-hidden">

              <!-- Dynamic dropdown content -->
              <template x-for="(dropdown, dropdownId) in dropdownContent" :key="dropdownId">
                  <div x-show="navigationMenu === dropdownId" class="p-4">
                      <div class="grid grid-cols-12 gap-4">

                          <!-- Column 1: Categories (hoverable) -->
                          <div class="col-span-3 bg-white rounded-2xl p-5">
                              <!-- Column 1 Header -->
                              <div class="flex items-center justify-between mb-4 pb-3 border-b border-neutral-100">
                                  <h3 class="text-sm font-semibold text-neutral-900" x-text="dropdown.column1.title"></h3>
                                  <a :href="dropdown.column1.link.url"
                                      @click="closeMenu()"
                                      class="text-xs font-medium text-brand-primary hover:underline">
                                      <span x-text="dropdown.column1.link.text"></span>
                                  </a>
                              </div>
                              <ul class="space-y-1">
                                  <template x-for="(category, index) in dropdown.categories" :key="category.id">
                                      <li>
                                          <button
                                              @mouseenter="activeCategory = category.id"
                                              :class="{ 'bg-neutral-100 text-neutral-900': activeCategory === category.id }"
                                              class="w-full text-left px-4 py-3 rounded-lg text-sm font-medium text-neutral-600 hover:bg-neutral-100 hover:text-neutral-900 transition-colors">
                                              <span x-text="category.label"></span>
                                          </button>
                                      </li>
                                  </template>
                              </ul>
                          </div>

                          <!-- Column 2: Dynamic links (up to 8) -->
                          <div class="col-span-5 bg-white rounded-2xl p-5">
                              <!-- Column 2 Header -->
                              <div class="flex items-center justify-between mb-4 pb-3 border-b border-neutral-100">
                                  <h3 class="text-sm font-semibold text-neutral-900" x-text="dropdown.column2.title"></h3>
                                  <a :href="dropdown.column2.link.url"
                                      @click="closeMenu()"
                                      class="text-xs font-medium text-brand-primary hover:underline">
                                      <span x-text="dropdown.column2.link.text"></span>
                                  </a>
                              </div>
                              <template x-for="(category, index) in dropdown.categories" :key="category.id">
                                  <div x-show="activeCategory === category.id" class="grid grid-cols-2 gap-3">
                                      <template x-for="link in category.links" :key="link.title">
                                          <a :href="link.url"
                                              @click="closeMenu()"
                                              class="group block p-3 rounded-lg hover:bg-neutral-50 transition-colors">
                                              <span class="block text-sm font-medium text-neutral-900 group-hover:text-brand-primary" x-text="link.title"></span>
                                              <span class="block text-xs text-neutral-500 mt-1" x-text="link.description"></span>
                                          </a>
                                      </template>
                                  </div>
                              </template>
                          </div>

                          <!-- Column 3: Fixed cards (2) -->
                          <div class="col-span-4 bg-white rounded-2xl p-5">
                              <!-- Column 3 Header -->
                              <div class="flex items-center justify-between mb-4 pb-3 border-b border-neutral-100">
                                  <h3 class="text-sm font-semibold text-neutral-900" x-text="dropdown.column3.title"></h3>
                                  <a :href="dropdown.column3.link.url"
                                      @click="closeMenu()"
                                      class="text-xs font-medium text-brand-primary hover:underline">
                                      <span x-text="dropdown.column3.link.text"></span>
                                  </a>
                              </div>
                              <div class="space-y-4">
                                  <template x-for="(card, index) in dropdown.cards" :key="index">
                                      <div class="relative rounded-xl overflow-hidden bg-neutral-100">
                                          <img :src="card.image" :alt="card.title" class="w-full h-28 object-cover">
                                          <div class="p-4">
                                              <h4 class="text-sm font-semibold text-neutral-900" x-text="card.title"></h4>
                                              <a :href="card.button.url"
                                                  @click="closeMenu()"
                                                  class="inline-flex items-center mt-2 text-xs font-medium text-brand-primary hover:underline">
                                                  <span x-text="card.button.text"></span>
                                                  <svg class="ml-1 w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                                                  </svg>
                                              </a>
                                          </div>
                                      </div>
                                  </template>
                              </div>
                          </div>

                      </div>
                  </div>
              </template>

          </div>
      </div>
  </div>
</header>

<script>
    function navigationMenu() {
        return {
            navigationMenuOpen: false,
            navigationMenu: '',
            activeCategory: '',
            navigationMenuCloseTimeout: null,
            navigationMenuCloseDelay: 200,

            menuItems: [
                {
                    id: 'getting-started',
                    label: 'Getting Started',
                    dropdown: true
                },
                {
                    id: 'learn-more',
                    label: 'Learn More',
                    dropdown: true
                },
                {
                    id: 'documentation',
                    label: 'Documentation',
                    url: '#documentation',
                    dropdown: false
                },
                {
                    id: 'contact',
                    label: 'Contact',
                    url: '#contact',
                    dropdown: false
                },
            ],

            dropdownContent: {
                'getting-started': {
                    column1: {
                        title: 'Browse',
                        link: { text: 'View all', url: '#all-categories' }
                    },
                    column2: {
                        title: 'Quick Links',
                        link: { text: 'See more', url: '#all-links' }
                    },
                    column3: {
                        title: 'Featured',
                        link: { text: 'View all', url: '#featured' }
                    },
                    categories: [
                        {
                            id: 'quick-start',
                            label: 'Quick Start',
                            links: [
                                { title: 'Introduction', description: 'Learn the basics and get up to speed', url: '#introduction' },
                                { title: 'Installation', description: 'Set up your development environment', url: '#installation' },
                                { title: 'First Project', description: 'Build your first project step by step', url: '#first-project' },
                                { title: 'Configuration', description: 'Configure your project settings', url: '#configuration' },
                                { title: 'Deployment', description: 'Deploy your project to production', url: '#deployment' },
                                { title: 'Best Practices', description: 'Learn recommended patterns', url: '#best-practices' }
                            ]
                        },
                        {
                            id: 'resources',
                            label: 'Resources',
                            links: [
                                { title: 'Components', description: 'Browse our UI component library', url: '#components' },
                                { title: 'Templates', description: 'Pre-built templates to jumpstart', url: '#templates' },
                                { title: 'Examples', description: 'Real-world examples and use cases', url: '#examples' },
                                { title: 'Plugins', description: 'Extend functionality with plugins', url: '#plugins' }
                            ]
                        },
                        {
                            id: 'support',
                            label: 'Help & Support',
                            links: [
                                { title: 'Documentation', description: 'Comprehensive guides and API reference', url: '#docs' },
                                { title: 'Community', description: 'Join our community forum', url: '#community' },
                                { title: 'FAQ', description: 'Frequently asked questions', url: '#faq' },
                                { title: 'Contact Support', description: 'Get help from our team', url: '#support' }
                            ]
                        }
                    ],
                    cards: [
                        {
                            image: 'https://placehold.co/400x200/e2e8f0/64748b?text=Getting+Started',
                            title: 'New to the platform?',
                            button: { text: 'Watch Tutorial', url: '#tutorial' }
                        },
                        {
                            image: 'https://placehold.co/400x200/dbeafe/3b82f6?text=Free+Trial',
                            title: 'Try it free for 14 days',
                            button: { text: 'Start Free Trial', url: '#trial' }
                        }
                    ]
                },
                'learn-more': {
                    column1: {
                        title: 'Topics',
                        link: { text: 'All topics', url: '#all-topics' }
                    },
                    column2: {
                        title: 'Resources',
                        link: { text: 'Browse all', url: '#all-resources' }
                    },
                    column3: {
                        title: 'Recommended',
                        link: { text: 'View all', url: '#recommended' }
                    },
                    categories: [
                        {
                            id: 'frameworks',
                            label: 'Frameworks',
                            links: [
                                { title: 'Tailwind CSS', description: 'Utility-first CSS framework', url: '#tailwind' },
                                { title: 'Alpine.js', description: 'Lightweight JavaScript framework', url: '#alpine' },
                                { title: 'Laravel', description: 'PHP framework for web artisans', url: '#laravel' },
                                { title: 'Livewire', description: 'Full-stack framework for Laravel', url: '#livewire' }
                            ]
                        },
                        {
                            id: 'tools',
                            label: 'Tools',
                            links: [
                                { title: 'Vite', description: 'Next generation frontend tooling', url: '#vite' },
                                { title: 'Webpack', description: 'Module bundler for JavaScript', url: '#webpack' },
                                { title: 'PostCSS', description: 'Transform CSS with JavaScript', url: '#postcss' },
                                { title: 'ESLint', description: 'Find and fix JavaScript problems', url: '#eslint' }
                            ]
                        },
                        {
                            id: 'learning',
                            label: 'Learning',
                            links: [
                                { title: 'Video Tutorials', description: 'Step-by-step video guides', url: '#videos' },
                                { title: 'Blog', description: 'Latest news and articles', url: '#blog' },
                                { title: 'Courses', description: 'In-depth courses and workshops', url: '#courses' },
                                { title: 'Webinars', description: 'Live and recorded sessions', url: '#webinars' }
                            ]
                        }
                    ],
                    cards: [
                        {
                            image: 'https://placehold.co/400x200/dcfce7/22c55e?text=Expert+Training',
                            title: 'Level up your skills',
                            button: { text: 'Browse Courses', url: '#courses' }
                        },
                        {
                            image: 'https://placehold.co/400x200/fef3c7/f59e0b?text=Certification',
                            title: 'Get certified today',
                            button: { text: 'View Certifications', url: '#certifications' }
                        }
                    ]
                }
            },

            openMenu(menuId) {
                this.cancelClose();
                this.navigationMenuOpen = true;
                this.navigationMenu = menuId;
                // Set first category as active by default
                const dropdown = this.dropdownContent[menuId];
                if (dropdown && dropdown.categories && dropdown.categories.length > 0) {
                    this.activeCategory = dropdown.categories[0].id;
                }
            },

            scheduleClose() {
                this.navigationMenuCloseTimeout = setTimeout(() => {
                    this.closeMenu();
                }, this.navigationMenuCloseDelay);
            },

            cancelClose() {
                if (this.navigationMenuCloseTimeout) {
                    clearTimeout(this.navigationMenuCloseTimeout);
                    this.navigationMenuCloseTimeout = null;
                }
            },

            closeMenu() {
                this.navigationMenuOpen = false;
                this.navigationMenu = '';
                this.activeCategory = '';
            }
        }
    }
</script>